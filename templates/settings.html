<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Navigation Menu -->
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/calibration">Calibration</a></li>
            <li><a href="/configuration">Configuration</a></li>
            <li><a href="/dosage">Dosage</a></li>
            <li><a href="/settings" class="active">Settings</a></li>
        </ul>
    </nav>

    <main>
        <h1>Settings</h1>
        <p class="subtitle">Manage system and device configurations.</p>

        <div class="data-container">
            <h2>Assign USB Devices</h2>
            <form id="ph-form">
                <label for="ph-device">pH Probe:</label>
                <select id="ph-device" name="ph-device">
                    <option value="">Select a device</option>
                </select>
                <button type="submit">Save pH Probe</button>
            </form>

            <form id="relay-form">
                <label for="relay-device">Relay Module:</label>
                <select id="relay-device" name="relay-device">
                    <option value="">Select a device</option>
                </select>
                <button type="submit">Save Relay Module</button>
            </form>

            <button id="rescan-usb" class="secondary-btn">Rescan USB Devices</button>
            <div id="status"></div>

            <div id="relay-warning" class="error-message" style="display: none;">
                <strong>Relay module not assigned. Dosing settings are disabled.</strong>
            </div>
        </div>

        <div class="data-container">
            <h2>pH Min/Max Range</h2>
            <form id="ph-range-form">
                <input type="number" id="ph-min" name="ph-min" step="0.01" placeholder="Min pH">
                <input type="number" id="ph-max" name="ph-max" step="0.01" placeholder="Max pH">
                <button type="submit">Save pH Range</button>
            </form>
        </div>

        <div class="data-container">
            <h2>General Settings</h2>
            <form id="general-settings-form">
                <input type="number" id="ph-target" name="ph-target" step="0.01" placeholder="pH Target" disabled>
                <input type="number" id="max-dosing" name="max-dosing" step="1" placeholder="Max Dosing Amount (ml)" disabled>
                <input type="number" id="dosing-interval" name="dosing-interval" step=".0001" placeholder="Dosing Interval (hours)" disabled>
                <input type="number" id="system-volume" name="system-volume" step=".1" placeholder="System Volume (gallons)" disabled>
                <input type="text" id="time-zone" name="time-zone" placeholder="Time Zone" disabled>
                
                <label class="checkbox-container">
                    <input type="checkbox" id="auto-dosing" name="auto-dosing" disabled> Auto-Dosing Enabled
                </label>

                <button type="submit" id="general-save-btn" disabled>Save General Settings</button>
            </form>
        </div>

        <div class="data-container">
            <h2>Plant Info</h2>
            <form id="plant-info-form">
                <input type="text" id="plant-name" name="plant-name" placeholder="Plant Name">
                <label>Plant Start Date:</label>
                <input type="date" id="plant-start-date" name="plant-start-date">
                <label>Weeks Since Start:</label>
                <span id="weeks-since-start">0</span>
                <button type="submit">Save Plant Info</button>
            </form>
        </div>
    </main>

</body>
</html>
